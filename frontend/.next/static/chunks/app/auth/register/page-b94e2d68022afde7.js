(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[454],{3272:function(e,t,a){Promise.resolve().then(a.bind(a,5266))},5266:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return page}});var r=a(7437),s=a(2265),n=a(4033),o=a(1396),l=a.n(o),u=a(680),i=a(6716),c=a.n(i),d=a(8529),h=a.n(d),m=a(192),p=a.n(m),Modal_Modal=e=>{let{isOpen:t,onRequestClose:a,contentLabel:s,children:n}=e;return(0,r.jsxs)(h(),{isOpen:t,onRequestClose:a,contentLabel:s,className:p().modal,overlayClassName:p().overlay,ariaHideApp:!1,children:[(0,r.jsx)("button",{onClick:a,className:p().closeButton,"aria-label":"Закрыть модальное окно",children:"\xd7"}),n]})},page=()=>{let{register:e}=(0,u.a)(),t=(0,n.useRouter)(),[a,o]=(0,s.useState)({username:"",email:"",password:""}),[i,d]=(0,s.useState)(null),[h,m]=(0,s.useState)(!1),handleChange=e=>o({...a,[e.target.name]:e.target.value}),handleSubmit=async r=>{r.preventDefault();let s=await e(a.username,a.email,a.password);s.success?t.push("/"):s.message.includes("email")?m(!0):d(s.message)};return(0,r.jsxs)("div",{className:c().authContainer,children:[(0,r.jsx)("h1",{children:"Регистрация"}),i&&(0,r.jsx)("p",{className:c().error,children:i}),(0,r.jsxs)("form",{onSubmit:handleSubmit,className:c().authForm,children:[(0,r.jsx)("label",{htmlFor:"username",children:"Имя пользователя:"}),(0,r.jsx)("input",{type:"text",name:"username",id:"username",value:a.username,onChange:handleChange,required:!0}),(0,r.jsx)("label",{htmlFor:"email",children:"Email:"}),(0,r.jsx)("input",{type:"email",name:"email",id:"email",value:a.email,onChange:handleChange,required:!0}),(0,r.jsx)("label",{htmlFor:"password",children:"Пароль:"}),(0,r.jsx)("input",{type:"password",name:"password",id:"password",value:a.password,onChange:handleChange,required:!0}),(0,r.jsx)("button",{type:"submit",className:c().submitButton,children:"Зарегистрироваться"})]}),(0,r.jsxs)("p",{children:["Уже есть аккаунт? ",(0,r.jsx)(l(),{href:"/auth/login",children:"Войти"})]}),(0,r.jsxs)(Modal_Modal,{isOpen:h,onRequestClose:()=>m(!1),contentLabel:"Ошибка Регистрации",children:[(0,r.jsx)("h2",{children:"Ошибка Регистрации"}),(0,r.jsx)("p",{children:"Эта почта уже зарегистрирована."}),(0,r.jsx)("button",{onClick:()=>m(!1),className:c().closeModalButton,children:"Закрыть"})]})]})}},680:function(e,t,a){"use strict";a.d(t,{H:function(){return AuthProvider},a:function(){return useAuth}});var r=a(7437),s=a(2265),n=a(6454),o=a(2164);let l=(0,s.createContext)(void 0),useAuth=()=>{let e=(0,s.useContext)(l);if(!e)throw Error("useAuth must be used within an AuthProvider");return e},AuthProvider=e=>{let{children:t}=e,[a,u]=(0,s.useState)(null),register=async(e,t,a)=>{try{let r=await (0,n.a$)(e,t,a);return u(r.data),localStorage.setItem("jwt",r.data.token),{success:!0,data:r.data}}catch(e){if(e instanceof o.d7){var r,s;return{success:!1,message:(null===(s=e.response)||void 0===s?void 0:null===(r=s.data)||void 0===r?void 0:r.message)||"Ошибка регистрации"}}if(e instanceof Error)return{success:!1,message:e.message||"Ошибка регистрации"};return{success:!1,message:"Произошла неизвестная ошибка"}}},login=async(e,t)=>{try{let a=await (0,n.pH)(e,t);return u(a.data),localStorage.setItem("jwt",a.data.token),!0}catch(e){return o.d7,!1}};return(0,r.jsx)(l.Provider,{value:{register,login,user:a,logout:()=>{u(null),localStorage.removeItem("jwt")}},children:t})}},6454:function(e,t,a){"use strict";a.d(t,{a$:function(){return registerUser},pH:function(){return loginUser}});var r=a(4829);let s=r.default.create({baseURL:"http://localhost:1337"});s.interceptors.request.use(e=>{let t=localStorage.getItem("jwt");return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e));let registerUser=(e,t,a)=>s.post("/api/auth/local/register",{username:e,email:t,password:a}),loginUser=(e,t)=>s.post("/api/auth/local",{identifier:e,password:t});t.ZP=s},6716:function(e){e.exports={authWrapper:"Auth_authWrapper__egwk6",authContainer:"Auth_authContainer__2JK_F",authForm:"Auth_authForm__GIM0l",submitButton:"Auth_submitButton__v_aQ3",error:"Auth_error__lfKpi",closeModalButton:"Auth_closeModalButton__CkRcm",googleLogin:"Auth_googleLogin__T6BnZ"}},192:function(e){e.exports={overlay:"Modal_overlay__2Sh3U",modal:"Modal_modal__JNobJ",closeButton:"Modal_closeButton__7VSKG"}}},function(e){e.O(0,[326,787,642,971,472,744],function(){return e(e.s=3272)}),_N_E=e.O()}]);