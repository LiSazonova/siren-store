(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[716],{49:function(e,t,r){Promise.resolve().then(r.bind(r,2015))},679:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{unstable_getImgProps:function(){return unstable_getImgProps},default:function(){return l}});let a=r(1024),s=r(7929),n=r(2637),o=r(413),i=a._(r(9950)),unstable_getImgProps=e=>{(0,n.warnOnce)("Warning: unstable_getImgProps() is experimental and may change or be removed at any time. Use at your own risk.");let{props:t}=(0,s.getImgProps)(e,{defaultLoader:i.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,r]of Object.entries(t))void 0===r&&delete t[e];return{props:t}},l=o.Image},2015:function(e,t,r){"use strict";r.r(t);var a=r(7437),s=r(2265),n=r(4033),o=r(1396),i=r.n(o),l=r(680),u=r(9586),c=r.n(u),d=r(6691),g=r.n(d);t.default=()=>{let{login:e}=(0,l.a)(),t=(0,n.useRouter)(),[r,o]=(0,s.useState)({identifier:"",password:""}),[u,d]=(0,s.useState)(null),handleChange=e=>o({...r,[e.target.name]:e.target.value}),handleSubmit=async a=>{a.preventDefault();let s=await e(r.identifier,r.password);s?t.push("/"):d("Ошибка входа. Проверьте данные и попробуйте снова.")};return(0,a.jsx)("section",{className:c().auth,children:(0,a.jsxs)("div",{className:c().authContainer,children:[(0,a.jsx)("div",{className:c().authDecoration,children:(0,a.jsx)(g(),{src:"/images/decorations/login_siren.svg",width:583,height:321,alt:"Login Decoration"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:c().authTitle,children:"ВХІД"}),u&&(0,a.jsx)("p",{className:c().error,children:u}),(0,a.jsxs)("form",{onSubmit:handleSubmit,className:c().authForm,children:[(0,a.jsx)("label",{htmlFor:"identifier",children:"Будь ласка, введіть свою електронну адресу"}),(0,a.jsx)("input",{type:"text",name:"identifier",id:"identifier",placeholder:"Електронна адреса",value:r.identifier,onChange:handleChange,required:!0}),(0,a.jsx)("label",{htmlFor:"password",children:"Будь ласка, введіть свій пароль"}),(0,a.jsx)("input",{type:"password",name:"password",id:"password",placeholder:"Пароль",value:r.password,onChange:handleChange,required:!0}),(0,a.jsx)("p",{className:c().forgotPassword,children:(0,a.jsx)(i(),{href:"/auth/forgot-password",children:"Забули пароль ?"})}),(0,a.jsx)("button",{type:"submit",className:c().submitButton,children:"УВІЙТИ"}),(0,a.jsx)("p",{className:c().registerLink,children:(0,a.jsx)(i(),{href:"/auth/register",children:"У МЕНЕ НЕМА ПРОФІЛЮ"})})]})]})]})})}},680:function(e,t,r){"use strict";r.d(t,{H:function(){return AuthProvider},a:function(){return useAuth}});var a=r(7437),s=r(2265),n=r(6454),o=r(2164);let i=(0,s.createContext)(void 0),useAuth=()=>{let e=(0,s.useContext)(i);if(!e)throw Error("useAuth must be used within an AuthProvider");return e},AuthProvider=e=>{let{children:t}=e,[r,l]=(0,s.useState)(null);(0,s.useEffect)(()=>{let e=localStorage.getItem("jwt"),t=localStorage.getItem("user");if(e&&t)try{let e=JSON.parse(t);l(e)}catch(e){console.error("Ошибка восстановления пользователя:",e),localStorage.removeItem("jwt"),localStorage.removeItem("user")}},[]);let register=async(e,t,r)=>{try{let a=await (0,n.a$)(e,t,r),{jwt:s,user:o}=a.data;return localStorage.setItem("jwt",s),localStorage.setItem("user",JSON.stringify(o)),l(o),{success:!0,data:a.data}}catch(e){if(e instanceof o.d7){var a,s,i;return{success:!1,message:(null===(i=e.response)||void 0===i?void 0:null===(s=i.data)||void 0===s?void 0:null===(a=s.error)||void 0===a?void 0:a.message)||"Ошибка регистрации"}}return{success:!1,message:"Произошла неизвестная ошибка"}}},login=async(e,t)=>{try{let r=await (0,n.pH)(e,t),{jwt:a,user:s}=r.data;return localStorage.setItem("jwt",a),localStorage.setItem("user",JSON.stringify(s)),l(s),!0}catch(e){return console.error("Ошибка логина:",e),!1}};return(0,a.jsx)(i.Provider,{value:{register,login,user:r,logout:()=>{l(null),localStorage.removeItem("jwt"),localStorage.removeItem("user")}},children:t})}},6454:function(e,t,r){"use strict";r.d(t,{a$:function(){return registerUser},pH:function(){return loginUser}});var a=r(4829);let s=a.default.create({baseURL:"https://siren-store.onrender.com"});s.interceptors.request.use(e=>{let t=localStorage.getItem("jwt");return t&&"/api/auth/local/register"!==e.url&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e));let registerUser=async(e,t,r)=>{console.log("Данные для API:",{username:e,email:t,password:r});try{let a=await s.post("/api/auth/local/register",{username:e,email:t,password:r});return console.log("Успешный ответ от API:",a.data),{success:!0,data:a.data}}catch(e){var a,n,o,i;return console.error("Ошибка в запросе API:",(null===(a=e.response)||void 0===a?void 0:a.data)||e.message),{success:!1,message:(null===(i=e.response)||void 0===i?void 0:null===(o=i.data)||void 0===o?void 0:null===(n=o.error)||void 0===n?void 0:n.message)||"Ошибка регистрации"}}},loginUser=async(e,t)=>{try{let r=await s.post("/api/auth/local",{identifier:e,password:t});return console.log("Логин успешен:",r.data),r}catch(e){var r;throw console.error("Ошибка логина:",(null===(r=e.response)||void 0===r?void 0:r.data)||e.message),e}};t.ZP=s},9586:function(e){e.exports={auth:"LoginPage_auth__bvUnk",authContainer:"LoginPage_authContainer__xbBqU",authTitle:"LoginPage_authTitle__Sp77X",authForm:"LoginPage_authForm__Q80WW",forgotPassword:"LoginPage_forgotPassword__fVD3U",authDecoration:"LoginPage_authDecoration__pjgSX",registerLink:"LoginPage_registerLink__rlqi3"}},6691:function(e,t,r){e.exports=r(679)},4033:function(e,t,r){e.exports=r(94)},2164:function(e,t,r){"use strict";r.d(t,{d7:function(){return n}});var a=r(4829);let{Axios:s,AxiosError:n,CanceledError:o,isCancel:i,CancelToken:l,VERSION:u,all:c,Cancel:d,isAxiosError:g,spread:h,toFormData:m,AxiosHeaders:f,HttpStatusCode:p,formToJSON:v,getAdapter:_,mergeConfig:w}=a.default}},function(e){e.O(0,[413,326,787,971,472,744],function(){return e(e.s=49)}),_N_E=e.O()}]);